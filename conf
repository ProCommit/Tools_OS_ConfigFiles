" =======================================
" COC (Conquer of Completion) - manual trigger only
" =======================================

" Disable automatic completion popups completely
let g:coc_enable_auto_trigger = 0

" Completion menu configuration
set completeopt=menu,menuone,noinsert,noselect

" --- Manual completion mappings ---

" Tab:
"   - If popup is open → move to next item
"   - Otherwise → trigger completion menu manually
inoremap <silent><expr> <Tab>
      \ coc#pum#visible() ? coc#pum#next(1) : coc#refresh()

" Shift+Tab:
"   - If popup is open → move to previous item
"   - Otherwise → perform backspace
inoremap <silent><expr> <S-Tab>
      \ coc#pum#visible() ? coc#pum#prev(1) : "\<C-h>"

" Enter:
"   Always creates a new line — never accepts completion
inoremap <silent><expr> <CR> "\<CR>"

" Space:
"   Always inserts a space, never confirms completion
inoremap <silent><expr> <Space> "\<Space>"

" Ctrl+Space:
"   Manually trigger completion (like in VSCode)
inoremap <silent><expr> <C-Space> coc#refresh()

" --- Optional: confirm selection manually with Ctrl+Y ---
inoremap <silent><expr> <C-y>
      \ coc#pum#visible() ? coc#pum#confirm() : "\<C-y>"

" --- LSP actions ---
nmap <silent> gd <Plug>(coc-definition)
nmap <silent> gr <Plug>(coc-references)
nmap <silent> K :call CocActionAsync('doHover')<CR>
nmap <leader>rn <Plug>(coc-rename)
nmap <leader>f <Plug>(coc-format)
