" =======================================
" COC (Conquer of Completion) - safe Enter config
" =======================================

" Let Coc suggest automatically (optional)
let g:coc_enable_auto_trigger = 1

" Completion popup settings
set completeopt=menu,menuone,noinsert,noselect

" --- Completion keymaps ---
" Tab: select next item if popup is visible, otherwise trigger completion
inoremap <silent><expr> <Tab>
      \ coc#pum#visible() ? coc#pum#next(1) : coc#refresh()

" Shift+Tab: select previous item
inoremap <silent><expr> <S-Tab>
      \ coc#pum#visible() ? coc#pum#prev(1) : "\<C-h>"

" Ctrl+Space: manually trigger suggestions
inoremap <silent><expr> <C-Space> coc#refresh()

" Enter: always insert newline â€” never confirm completion
inoremap <silent><expr> <CR> "\<CR>"

" Space: just insert a space, never confirm
inoremap <silent><expr> <Space> "\<Space>"

" --- Optional: confirm selection manually with Ctrl+y ---
" (like in VSCode when pressing Enter on purpose)
inoremap <silent><expr> <C-y>
      \ coc#pum#visible() ? coc#pum#confirm() : "\<C-y>"

" --- LSP actions ---
nmap <silent> gd <Plug>(coc-definition)
nmap <silent> gr <Plug>(coc-references)
nmap <silent> K :call CocActionAsync('doHover')<CR>
nmap <leader>rn <Plug>(coc-rename)
nmap <leader>f <Plug>(coc-format)
